pipeline {
    agent any
    stages {
        stage('Run Newman tests') {
            steps {
                bat 'scripts\\run-tests.bat'
            }
        }
        stage('Publish Allure report to GitHub Pages') {
            steps {
                bat '''
                cd ..
                xcopy k6-performance-tests\\allure-report\\* qa-allure-reports /E /H /C /I /Y
                cd qa-allure-reports
                git add .
                git commit -m "Update report %date% %time%"
                git push origin main
                '''
            }
        }
    }
}